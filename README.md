# Optimization of Decentralized Multivariable Decoupling Control for a SAFEHX¬Æ Heat Exchanger

This repository contains the source code, simulation models, and experimental data for the implementation of a **PIDDec** (PID-based Decoupler) strategy. The method is applied to a strongly coupled multivariable TITO (Two-Input Two-Output) system: a 100kW prototype of the patented **SAFEHX¬Æ** (Buffered Heat Exchanger) developed by Clark Solutions.

## üìã Project Overview

Industrial multivariable systems often exhibit strong cross-interactions among variables. This project proposes a practical decoupling strategy using a standard PID structure repurposed as a feedforward element, henceforth referred to as **PIDDec**. This approach circumvents the limitations of traditional decoupling (such as non-causality or instability in non-minimum phase systems) by using a data-driven optimization-based approximation.

### Key Features
* **System Identification:** Data-driven modeling using Pseudo-Random Binary Signals (PRBS) and Output Error (OE) algorithms.
* **PIDDec Structure:** Repurposing the Siemens `PID_Compact` algorithm as a cross-coupling decoupler.
* **Optimization:** Parameter optimization using Response Surface Methodology (RSM) implemented in Python.
* **Open-Source Tools:** Development performed entirely using Octave, Scilab/Xcos, and Python.

---

## ‚öôÔ∏è Prerequisites

To replicate this study, you will need the following software installed:

1.  **Octave 6.x+**
    * Library: [MataveID](https://github.com/DanielMartensson/MataveID)
    * Library: [MataveControl](https://github.com/DanielMartensson/MataveControl)
2.  **Scilab 6.1.1** (Required environment for Xcos simulations)
3.  **Python 3.8+**
    * Libraries: `numpy`, `scipy`, `scikit-learn`

---

## üöÄ Execution Workflow

### 1. System Identification (Octave)
Navigate to `src/octave/` and run the script `Identificacao_Sistema_rev7_Respostas_2.m`.

* **Input:** The script loads experimental data (`Resposta_Valvula_2.csv` and `Resposta_Inversor_2.csv`).
* **Process:** It estimates the transfer function matrix $G(s)$ and validates it via Coefficient of Determination ($R^2$).
* **Output:** Generates a Scilab-compatible file `saida_scilab.sci` containing the identified plant model.

### 2. RSM Data Generation (Scilab/Xcos)
Navigate to `src/scilab/` and execute `Model_Run4.sci`.

* **Process:** This script runs a batch of simulations (e.g., 729 runs per iteration) to map the response surface of the system.
* **Watchdog:** If Scilab crashes due to memory overhead during long batches, run `Rodar_Scilab.bat` (located in `src/automation/`) to automatically restart the process and resume data collection.
* **Output:** Generates `resultados_RSMXX.sci` (where `XX` is the iteration number), containing RSS and overshoot metrics.

### 3. Parameter Optimization (Python)
Navigate to `src/python/` and run `RSM_Otimizacao_SAFEHX_rev4.py`.

* **Input:** The script reads the results file generated by Scilab.
* **Process:** Fits a second-order polynomial to the simulation data and uses **Ridge Regression** to find optimal PIDDec coefficients.
* **Output:** Prints the optimized coefficients ($K_p, T_i, T_d, a, b, c$).

### 4. Iteration
Manually update the `py_param` variable inside `Model_Run4.sci` with the new coefficients obtained from Python and repeat steps 2 and 3 until the RSS error converges (< 1%).

---

## üìä Results

The optimized PIDDec successfully reduced the flow overshoot caused by pressure disturbances from **243.4%** to **2.13%**. Following decoupling, the flow controller ($K_{22}$) was retuned, achieving a settling time ($T_{95}$) **10 times faster** than the original non-decoupled system.

## üë• Authors

* **Alexandre Rossi** - [alexandre-rossi](https://github.com/alexandre-rossi)
* **Claudio Garcia** - *Escola Polit√©cnica, University of S√£o Paulo (USP)*
* **Diego Col√≥n** - *Escola Polit√©cnica, University of S√£o Paulo (USP)*

## üôè Acknowledgments

The authors thank **Clark Solutions** for providing the **SAFEHX¬Æ** prototype and the R&D resources required for this study.

---

## üìÇ Repository Structure

```text
/
‚îú‚îÄ‚îÄ data/                     # Experimental CSV data from the pilot plant
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ octave/               # System Identification module
‚îÇ   ‚îú‚îÄ‚îÄ scilab/               # Xcos simulation and RSM data generation
‚îÇ   ‚îú‚îÄ‚îÄ python/               # RSM Optimization scripts
‚îÇ   ‚îî‚îÄ‚îÄ automation/           # Watchdog scripts for process stability
‚îî‚îÄ‚îÄ docs/                     # Technical diagrams and figures
